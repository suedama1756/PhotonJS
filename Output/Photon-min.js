(function(y){(function(b){"function"===typeof require&&"object"===typeof exports&&"object"===typeof module?b(module.exports||exports):"function"===typeof define&&define.amd?define(["exports","jquery"],b):(y.photon=y.photon||{},b(y.photon,y.$))})(function(b,k){function y(a,c,b,e,f,g,h){for(;c<b&&f<g&&h(a.data[c],e.data[f]);)c++,f++;for(;c<b&&f<g&&h(a.data[b-1],e.data[g-1]);)--b,--g;if(c===b)for(;f<g;)e.modified[f++]=!0;else if(f===g)for(;c<b;)a.modified[c++]=!0;else{var i;a:{i=c;var j=b,u=f,B=g,k=
{},n=a.length+e.length+1,p=i-u,s=j-B,v=0!==(j-i-(B-u)&1),o=Array(2*n+2),l=Array(2*n+2),w=n-p,n=n-s,x=(j-i+B-u)/2+1;o[w+p+1]=i;l[n+s-1]=j;for(var q,z,t=0;t<=x;t++){for(var m=p-t;m<=p+t;m+=2){m===p-t?q=o[w+m+1]:(q=o[w+m-1]+1,m<p+t&&o[w+m+1]>=q&&(q=o[w+m+1]));for(z=q-m;q<j&&z<B&&h(a.data[q],e.data[z]);)q++,z++;o[w+m]=q;if(v&&s-t<m&&m<s+t&&l[n+m]<=o[w+m]){k.x=o[w+m];k.y=o[w+m]-m;i=k;break a}}for(m=s-t;m<=s+t;m+=2){m===s+t?q=l[n+m-1]:(q=l[n+m+1]-1,m>s-t&&l[n+m-1]<q&&(q=l[n+m-1]));for(z=q-m;q>i&&z>u&&h(a.data[q-
1],e.data[z-1]);)q--,z--;l[n+m]=q;if(!v&&p-t<=m&&m<=p+t&&l[n+m]<=o[w+m]){k.x=o[w+m];k.y=o[w+m]-m;i=k;break a}}}r(!1);i=void 0}y(a,c,i.x,e,f,i.y,h);y(a,i.x,b,e,i.y,g,h)}}function M(a,c){for(var b=[],e,f,g=0,h=0,i=a.length,j=c.length;g<i||h<j;)if(g<i&&!a.modified[g]&&h<j&&!c.modified[h])g++,h++;else{e=g;for(f=h;g<i&&(h>=j||a.modified[g]);)g++;for(;h<j&&(g>=i||c.modified[h]);)h++;(e<g||f<h)&&b.push({startA:e,startB:f,deletedA:g-e,insertedB:h-f})}return b}function N(a){return a.replace(/(&quot;|&lt;|&gt;|&amp;)/g,
function(a,b){return O[b]})}function P(a){return this===a||a.flowTemplate_}function H(a,c,d){d=c===d?null:(d=b.dom.findParent(c,P,d))?d.flowTemplate_:null;d=new b.templating.FlowTemplate(d);d.getParent()||a.push(d);d.element_=c;c.flowTemplate_=d;c.setAttribute("data-template-id",d.getKey())}function I(a){var c=a.element_;if(c){var d=a.children_;if(d)for(var e=0,f=d.length;e<f;e++)I(d[e]);a.setTemplate(c.innerHTML);b.dom.empty(c);delete a.element_}}defineNamespace=function(a,c){for(var d=a.split("."),
e=b,f=0,g=d.length;f<g;f++)e=e[d[f]]=e[d[f]]||{};return b.extend(e,c)};provide=function(a,c){var d=a.split(".");if("photon"!==d[0])throw Error();for(var e=b,f=1,g=d.length;f<g;f++)e=e[d[f]]=e[d[f]]||{};return b.extend(e,c)};b.provide=provide;(function(){function a(a,c){return function(){var b=this.superType;this.superType=c;try{return a.apply(this,arguments)}finally{this.superType=b}}}var c=/xyz/.test(function(){})?/\bsuperType\b/:/.*/;b.defineType=function(d,e,f,g){function h(){}b.isFunction(e)||
(g=f,f=e,e=null);var i=null;e&&(i=e.prototype,h.prototype=i);d.prototype=new h;d.prototype.constructor=d;d.superType=i;d.base=function(a){i&&d.superType.constructor.apply(a,l.slice.call(arguments,1))};f&&b.extend(d.prototype,f,b.extend.filterHasOwnProperty,function(d,f){var g=d[f];return e&&b.isFunction(g)&&c.test(g)?a(g,i):g});g&&b.extend(d,g);return d}})();var E=Object.prototype,A=String.prototype,l=Array.prototype;b.isUndefined=function(a){return void 0===a};b.isNullOrUndefined=function(a){return null===
a||b.isUndefined(a)};b.isString=function(a){return"string"===typeof a};b.isElement=function(a){return a&&1===a.nodeType};b.isDocument=function(a){return a&&9===a.nodeType};b.isDocumentOrElement=function(a){return a&&(1===a.nodeType||9===a.nodeType)};b.isDocumentFragment=function(a){return a&&11===a.nodeType};b.isFunction=function(a){return"function"===typeof a};b.isArray=function(a){return"[object Array]"===E.toString.call(a)};b.UID_PROPERTY_="photon_uid"+Math.floor(2147483648*Math.random()).toString(36);
b.nextUID_=0;b.getUID=function(a){return a[b.UID_PROPERTY_]||(a[b.UID_PROPERTY_]=++b.nextUID_)};b.extend=function(a,c,b,e){for(var f in c)if(!b||b(c,f))a[f]=e?e(c,f):c[f];return a};b.extend.filterHasOwnProperty=function(a,c){return a.hasOwnProperty(c)};b.extend.filterHasOwnFunction=function(a,c){return a.hasOwnProperty(c)&&b.isFunction(a[c])};provide("photon.object",{toBoolean:function(a){return"boolean"==typeof a?a:b.isString(a)&&(a=a.toLowerCase(),b.object.toBoolean.map.hasOwnProperty(a))?b.object.toBoolean.map[a]:
a?!0:!1},toNullableBoolean:function(a){return b.isNullOrUndefined(a)?null:b.object.toBoolean(a)},toText:function(a){return""+a},toNullableText:function(a){return b.isNullOrUndefined(a)?null:b.object.toString(a)},toNumber:function(a){return Number(a)},toNullableNumber:function(a){var c=Number(a);return 0===c&&b.string.isWhiteSpace(a)?null:c},equals:function(a,c,d){d=d||[];if(a===c)return 0!==a||1/a==1/c;if(b.isNullOrUndefined(a)||b.isNullOrUndefined(c))return a===c;a._chain&&(a=a._wrapped);c._chain&&
(c=c._wrapped);if(a.equals&&_.isFunction(a.equals))return a.equals(c);if(c.equals&&_.isFunction(c.equals))return c.equals(a);var e=E.toString.call(a);if(e!==E.toString.call(c))return!1;switch(e){case "[object String]":return a===""+c;case "[object Number]":return a!==+a?c!==+c:0===a?1/a===1/c:a===+c;case "[object Date]":case "[object Boolean]":return+a===+c;case "[object RegExp]":return a.source===c.source&&a.global===c.global&&a.multiline===c.multiline&&a.ignoreCase===c.ignoreCase}if("object"!==
typeof a||"object"!==typeof c)return!1;for(var f=d.length;f--;)if(d[f]===a)return!0;d.push(a);var f=0,g=!0;if("[object Array]"===e){if(f=a.length,g=f===c.length)for(;f--&&(g=f in a===f in c&&b.object.equals(a[f],c[f],d)););}else{if("constructor"in a!=="constructor"in c||a.constructor!==c.constructor)return!1;for(var h in a)if(a.hasOwnProperty(h)&&(f++,!(g=c.hasOwnProperty(h)&&b.object.equals(a[h],c[h],d))))break;if(g){for(h in c)if(c.hasOwnProperty(h)&&!f--)break;g=!f}}d.pop();return g},getPropertyNames:function(a){var c=
[],b=0,e;for(e in a)c[b++]=e;return c},getOwnPropertyNames:function(a){var c=[],b=0,e;for(e in a)a.hasOwnProperty(e)&&(c[b++]=e);return c},forEachOwnProperty:function(a,c,b){for(var e in a)a.hasOwnProperty(e)&&c.call(b,e)}});b.object.toBoolean.map={"true":!0,yes:!0,1:!0,y:!0,"false":!1,no:!1,"0":!1,n:!1};provide("photon.string",{EMPTY:"",format:function(a){if(0!==arguments.length){if(1===arguments.length)return a;var c=k.makeArray(arguments).slice(1);return a.replace(/\{\{|\}\}|\{(\d+)\}/g,function(a,
b){return"{{"===a?"{":"}}"===a?"}":c[b]})}},isWhiteSpace:function(a){return!/[^\t\n\r ]/.test(a)},trim:A&&A.trim?function(a){return A.trim.call(a)}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},split:5==="-A-B-A-C".split(/-(A)-/).length?function(a,c,b){return A.split.call(a,c,b)}:function(){var a=void 0===/()??/.exec("")[1],c=function(){for(var a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(match[a]=void 0)};return function(b,e,f){if("[object RegExp]"!==Object.prototype.toString.call(e))return A.split.call(b,
e,f);var g=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),i=0,j,u,k,e=RegExp(e.source,h+"g"),b=b+"";a||(j=RegExp("^"+e.source+"$(?!\\s)",h));for(f=void 0===f?4294967295:f>>>0;h=e.exec(b);){u=h.index+h[0].length;if(u>i&&(g.push(b.slice(i,h.index)),!a&&1<h.length&&h[0].replace(j,c),1<h.length&&h.index<b.length&&Array.prototype.push.apply(g,h.slice(1)),k=h[0].length,i=u,g.length>=f))break;e.lastIndex===h.index&&e.lastIndex++}i===b.length?(k||!e.test(""))&&g.push(""):
g.push(b.slice(i));return g.length>f?g.slice(0,f):g}}()});provide("photon.errors",{notImplemented:function(){return Error("Not implemented")},objectDisposed:function(){return Error("Object disposed")}});var r=function(a,c){if(!a)throw Error(c?b.string.format.apply(null,[c].concat(l.slice.call(arguments,2))):"Value required.");return a};b.assert=r;provide("photon.expression");b.expression.makeScoped=function(a,c){for(var b=a,e=c.length-1;0<=e;e--)b="with("+c[e]+") { "+b+" } ";return b};provide("photon.functions");
b.functions.makeScoped=function(a,c,d){3>arguments.length&&(d=c);return new Function(d,b.expression.makeScoped(a,c))};provide("photon.array",{find:function(a,c,d,e){c=b.array.findIndex(a,c,d,e);return-1!==c?a[c]:null},findIndex:function(a,c,d,e){b.isFunction(c)&&(e=d,d=c,c=0);for(var f=a.length;c<f;c++)if(d.call(e,a[c],c,a))return c;return-1},map:l&&l.map?function(a,c,b){return l.map.call(a,c,b)}:function(a,c,d){for(var e=a.length,f=Array(e),g=b.isString(a)?a.split(""):a,h=0;h<e;h++)h in g&&(f[h]=
c.call(d,g[h],h,a));return f},filter:l&&l.filter?function(a,b,d){return l.filter.call(a,b,d)}:function(a,c,d){for(var e=a.length,f=[],g=0,h=b.isString(a)?a.split(""):a,i=0;i<e;i++)if(i in h){var j=h[i];c.call(d,j,i,a)&&(f[g++]=j)}return f},forEach:l&&l.forEach?function(a,b,d){l.forEach.call(a,b,d)}:function(a,c,d){for(var a=b.isString(a)?a.split(""):a,e=0,f=a.length;e<f;e++)e in a&&c.call(d,a[e],e,a)},indexOf:l&&l.indexOf?function(a,b,d){return l.indexOf.call(a,b,d)}:function(a,c,d){d=b.isNullOrUndefined(d)?
0:0>d?Math.max(0,a.length+d):d;if(b.isString(a))return!b.isString(c)||1!==c.length?-1:a.indexOf(c,d);for(var e=a.length;d<e;d++)if(d in a&&a[d]===c)return d;return-1},removeDuplicates:function(a,c,d,e){b.isFunction(c)&&(e=d,d=c,c=null);for(var c=c||a,f={},g=0,h=0;h<a.length;){var i=a[h++];d&&(i=d.call(e,i));var j=typeof i,j="object"===j&&null!==i?"o"+b.getUID(i):j.charAt(0)+i;f.hasOwnProperty(j)||(f[j]=!0,c[g++]=i)}c.length=g},diff:function(a,b,d){a={length:a.length,data:a,modified:[]};b={length:b.length,
data:b,modified:[]};y(a,0,a.length,b,0,b.length,d||function(a,b){return a===b});return M(a,b)},toArray:function(a,c,d){if(b.isArray(a))return a;var e=[],c=c||0;for(b.isUndefined(d)&&(d=a.length-c);c<d;c++)e[c]=a[c];return e},remove:function(a,c){var d=b.array.indexOf(a,c);return-1!==d?(a.splice(d,1),!0):!1}});b.StringBuilder=function(){this.bufferLength_=0;this.buffer_=[]};b.defineType(b.StringBuilder,{getLength:function(){return this.toString().length},clear:function(){this.bufferLength_=this.buffer_.length=
0},push:function(a){this.buffer_[this.bufferLength_++]=a},pushAll:function(a){for(var b=0,d=a.length;b<d;b++)this.push(a[b])},get:function(){var a=this.buffer_.join("");this.set(a);return a},set:function(a){this.clear();this.push(a)}});provide("photon.dom");b.dom.wrap=function(a,b,d){b=(d||document).createElement(b);b.appendChild(a);return b};b.dom.getHtml=function(a){if(b.isDocumentFragment(a)){var c=document.createElement("div");c.appendChild(a);for(var d=c.innerHTML;c.firstChild;)a.appendChild(c.firstChild);
return d}return a.innerHTML};var x={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"]};x.optgroup=x.option;x.tbody=x.tfoot=x.colgroup=x.caption=x.thead;x.th=x.td;b.dom.htmlToFragmentOrNode=function(a,b){var b=b||document,d=b.createElement("div"),
e=a.match(/^\s*<(t[dhr]|tbody|tfoot|thead|option|legend|col|area|optgroup|colgroup|caption)/i);if(e){var e=x[e[1].toLowerCase()],f=e[0];for(d.innerHTML=e[1]+a+e[2];f--;)d=d.lastChild}else d.innerHTML="<br>"+a,d.removeChild(d.firstChild);if(1===d.childNodes.length)return d.removeChild(d.firstChild);for(e=b.createDocumentFragment();d.firstChild;)e.appendChild(d.firstChild);return e};b.dom.findParent=function(a,b,d){if(!a)return null;for(var e=a.parentNode;e&&!b.call(d,e,a);)e=e.parentNode;return e};
b.dom.hasFocus=function(a,b){if(1===arguments.length)return a===document.activeElement;b?a.focus():a.blur()};(function(){var a=!b.isNullOrUndefined(k),c=[],d=function(a){for(var b=0,d=c.length;b<d;b++)c[b](a);if(1===a.nodeType||9===a.nodeType)a.photonData=void 0},e=function(a){for(var a=b.array.toArray(a),c=0,e=a.length;c<e;c++)d(a[c])};if(a){if(!k.cleanData)throw Error("Could not override jQuery 'cleanData'!!");var f=k.cleanData;k.cleanData=function(a){e(a);f(a)}}b.dom.subscribeToCleanup=function(a){c.push(a)};
b.dom.cleanNodes=function(a){for(var b=0,c=a.length;b<c;b++)this.cleanNode(a[b])};b.dom.remove=function(a){var b=a.parentNode;b&&b.removeChild(a)};b.dom.removeAndClean=function(a){b.dom.remove(a);b.dom.cleanNode(a)};b.dom.cleanNode=a?function(a){(1===a.nodeType||9===a.nodeType)&&k.cleanData(a.getElementsByTagName("*"));k.cleanData([a])}:function(a){(1===a.nodeType||9===a.nodeType)&&e(a.getElementsByTagName("*"));d(a)};b.dom.empty=function(a){for(;a.firstChild;)b.dom.cleanNode(a.firstChild),a.removeChild(a.firstChild)}})();
provide("photon.events",{add:function(a,b,d,e){k(a).on(b,d,e)}});provide("photon.observable");b.observable.unwrap=function(a){return b.isNullOrUndefined(a)?a:!0===a.isObservable&&a.unwrap?a.unwrap(a):a};var F=0;provide("photon.observable.model",{createPropertyChangeNotifier_:function(a){return function(b,d){this[a].call(this,b,d)}},createPropertySetter_:function(a){return function(b){return this.set(a,b)}},createPropertyGetter_:function(a){return function(){return this.get(a)}},createPropertyAccessor_:function(a,
b){var d=function(d){return d||0<arguments.length?(r(!b,"Property '{0}' is read only.",a),this.set(a,arguments[0])):this.get(a)};d.isPropertyAccessor=!0;return d},defineProperties_:function(a,c,d){b.object.forEachOwnProperty(c,function(b){"property"===d?Object.defineProperty(a,b,{get:this.createPropertyGetter_(b),set:property.isReadOnly?null:this.createPropertySetter_(b),enumerable:!0,configurable:!1}):a[b]=this.createPropertyAccessor_(b,c[b].isReadOnly)},this)},getDefaultDisplayName_:function(a){a=
a.replace(/([A-Z])/g," $1");return a.charAt(0).toUpperCase()+a.substring(1)},addExtension_:function(a,b,d){d&&d.define(a)},prepareModelDefinition_:function(a,c){var d={extensions:[],properties:{},methods:{}};c&&(b.extend(d.properties,c.properties),b.extend(d.methods,c.methods));var e=b.observable.model.extensions;b.object.forEachOwnProperty(e,function(b){var c=e[b];this.addExtension_(a,b,c);d.extensions.push(c)},this);b.object.forEachOwnProperty(a,function(c){var e=a[c];if(b.isFunction(e))d.methods[c]=
{methodName:c,method:e};else{if(!e||b.array.indexOf(["number","string","boolean"],typeof e)!==-1)e={initialValue:e};e.propertyName=c;d.properties[c]=this.preparePropertyDefinition_(e)}},this);return d},preparePropertyDefinition_:function(a){var c={},d=a.type;d&&b.extend(c,r(b.observable.model.types[d],"Model type '{0}' has not been registered",d));b.extend(c,a);b.isString(c.beforeChange)&&(c.beforeChange=this.createPropertyChangeNotifier_(c.beforeChange));b.isString(c.afterChange)&&(c.afterChange=
this.createPropertyChangeNotifier_(c.afterChange));if(c.coerce&&!b.isFunction(c.coerce))if(b.isString(c.coerce))c.coerce=b.observable.model.coercers[c.coerce];else if(b.isArray(c.coerce)){var e=b.array.map(c.coerce,function(a){var c=b.isFunction(a)?a:b.observable.model.coercers[a];return r(c,"Coercion type '{0}' is not registered",a)});c.coerce=function(a){for(var b=0,c=e.length;b<c;b++)a=e[b](a);return a}}F||(c.metaData=c.metaData||{},b.extend(c.metaData,this.getDefaultPropertyMetaData(c)));F++;
try{if(c.metaData){var f=b.observable.model.define(c.metaData);c.metaData=new f}}finally{F--}return c},define:function(a,c,d){1===arguments.length?(d=a,a=c=null):2===arguments.length&&(d=c,c=null);d=this.prepareModelDefinition_(d,c?c.prototype.definition_:null);c||(c=b.observable.model.Base);a||(a=function(b){a.base(this,b)});b.defineType(a,c,{definition_:d});this.defineProperties_(a.prototype,d.properties,b.observable.model.defaultPropertyMode);b.extend(a.prototype,d.methods,b.extend.filterHasOwnProperty,
function(a,b){return a[b].method});return a},isPropertyAccessor:function(a){return b.isFunction(a)&&a.isPropertyAccessor}});b.observable.model.defaultPropertyMode="function";b.observable.model.getDefaultPropertyMetaData=function(a){return{displayName:{initialValue:this.getDefaultDisplayName_(a.propertyName)}}};b.observable.model.extensions={};b.observable.model.coercers={};b.observable.model.metaData=function(a,c){var d=b.isFunction(a)?a.prototype.definition_:a.definition_;return d?d.properties[c].metaData:
null};b.observable.model.Base=function(a){this.initialize(a);if(b.isFunction(this.onInitialize))this.onInitialize()};b.defineType(b.observable.model.Base,{get:function(a){b.observable.DependencyTracker.registerDependency(this,a);return this.propertyValues_[a]},set:function(a,b){var d=this.definition_.extensions,e=this.definition_.properties[a];if(!e)throw Error();var f=this.propertyValues_[a];if(f!==b){e.coerce&&(b=e.coerce(b,f));e.beforeChange&&e.beforeChange.call(this,f,b);for(var g=0;g<d.length;g++)d[g].beforeChange(this,
e,f,b);this.propertyValues_[a]=b;e.afterChange&&e.afterChange.call(this,f,b);for(g=0;g<d.length;g++)d[g].afterChange(this,e,f,b);this.notifyPropertyChanged(a,f,b);return!0}return!1},notifyPropertyChanged:function(a,b,d){if(this.subscribers_){a={sender:this,propertyName:a,oldValue:b,newValue:d};b=0;for(d=this.subscribers_.length;b<d;b++)this.subscribers_[b]&&this.subscribers_[b].notify(a)}},subscribe:function(a,c,d,e){4>arguments.length&&"String"===typeof c&&(e=d,d=c,c=null);d&&this.definition_.properties[d]&&
(d=this.definition_.properties[d].propertyName);this.subscribers_=this.subscribers_||[];var f=new b.observable.Subscriber(this,a,c,d,e);this.subscribers_.push(f);return f},unsubscribe:function(a){return b.array.remove(this.subscribers_,a)},initialize:function(a){this.propertyValues_={};var c=this;b.extend(this.propertyValues_,this.definition_.properties,b.extend.filterHasOwnProperty,function(b,e){var f=b[e],g=f.initializer?f.initializer(c):f.initialValue;a&&f.propertyName in a&&(g=a[f.propertyName]);
return f.coerce?f.coerce(g,void 0):g})},isObservable:!0});b.observable.model.coercers.trim=function(a){return a?b.string.trim(a):""};b.observable.model.coercers.initCaps=function(a){for(var a=a.split(" "),b=0;b<a.length;b++)0<a.length&&(a[b]=a[b].charAt(0).toUpperCase()+a[b].substring(1));return a.join(" ")};b.observable.model.coercers.upper=function(a){return a?a.toUpperCase():""};b.observable.model.coercers.lower=function(a){return a?a.toUpperCase():""};provide("photon.observable.model.types");
b.extend(b.observable.model.types,{Boolean:{coerce:b.object.toBoolean,initialValue:!1},"Boolean?":{coerce:b.object.toNullableBoolean,initialValue:null},String:{coerce:b.object.toText,initialValue:""},"String?":{coerce:b.object.toNullableText,initialValue:null},Number:{coerce:b.object.toNumber,initialValue:!1},"Number?":{coerce:b.object.toNullableNumber,initialValue:!1},ObservableArray:{coerce:function(a,c){if(b.isNullOrUndefined(a))return a;c||(c=new b.observable.Array);c.set(a);return c},initializer:function(){return new b.observable.Array}}});
b.observable.Subscriber=function(a,b,d,e,f){this.owner_=a;this.callback_=b;d&&(this.callbackTarget_=d);e&&(this.propertyName_=e);"undefined"!==typeof f&&(this.data_=f)};b.extend(b.observable.Subscriber.prototype,{dispose:function(){this.owner_&&this.owner_.unsubscribe(this);this.owner_=this.callback_=null},notify:function(a){if(this.callback_&&(a.data=this.data_,!this.propertyName_||a.propertyName===this.propertyName_))this.callback_.call(this.callbackTarget_||null,a)},isSubscribedTo:function(a,b){return this.owner_===
a&&this.propertyName_===b},getOwner:function(){return this.owner_},propertyName:function(){return this.propertyName_},callbackTarget:function(){return this.callbackTarget_},callback:function(){return this.callback_},data:function(){return this.data_}});b.defineType(b.observable.Array=function(a){this.array_=a||[]},{isObservable:!0,push:function(){var a=l.push.apply(this.array_,arguments);this.notifyChanged(!0);return a},pop:function(){if(0<this.array_.length){var a=this.array_.pop();this.notifyChanged(!0);
return a}},shift:function(){if(0<this.array_.length){var a=this.array_.shift();this.notifyChanged(!0);return a}},unshift:function(){var a=l.unshift.apply(this.array_,arguments);this.notifyChanged(!0);return a},reverse:function(){this.array_.reverse();this.notifyChanged(!1);return this},sort:function(a){this.array_.sort(a);this.notifyChanged(!1);return this},slice:function(a,c){return new b.observable.Array(this.array_.slice(a,c))},splice:function(a,b,d){var e=this.array_,f=e.length,g=l.splice.apply(e,
arguments);this.notifyChanged(e.length!==f);return g},set:function(a){if(this!==a)if(a){var c=b.observable.unwrap(a);if(this.array_!==c){var d=this.length();if(!b.isArray(c)||a!==c){for(var a=[],e=0,f=c.length;e<f;e++)a[e]=c[e];c=a}this.array_=c;((c=d!==this.length())||0<d)&&this.notifyChanged(c)}}else 0<this.length()&&this.set([])},remove:function(a){(a=b.array.remove(this.array_,a))&&this.notifyChanged(!0);return a},concat:function(){return new b.observable.Array(l.concat.apply(this.array_,arguments))},
join:function(a){return new b.observable.Array(this.array_.join(a))},valueOf:function(){return this.array_.valueOf()},toString:function(){return this.array_.toString()},getItem:function(a){return this.array_[a]},setItem:function(a,b){var d=this.array_.length;this.array_[a]=b;this.notifyChanged(d!==this.array_.length)},subscribe:function(a,c,d){this.subscribers_=this.subscribers_||[];a=new b.observable.Subscriber(this,a,c,null,d);this.subscribers_.push(a);return a},unsubscribe:function(a){return b.array.remove(this.subscribers_,
a)},notifyChanged:function(a){var c=this.subscribers_;c&&(c=c.slice(0),b.array.forEach(c,function(b){(!b.propertyName()||a&&"length"===b.propertyName())&&b.notify({data:{}})}))},forEach:function(a,c){b.array.forEach(this.array_,a,c)},length:function(){b.observable.DependencyTracker.registerDependency(this,"length");return this.array_.length},indexOf:function(a,c){return b.array.indexOf(this.array_,a,c)},findIndex:function(a,c){return b.array.findIndex(this.array_,a,c)},unwrap:function(){return this.array_}});
(function(){function a(a,b,c){if(a)for(var d=0,i=a.length;d<i;d++)if(a[d]&&a[d].isSubscribedTo(b,c))return d;return-1}var c=[],d=null;b.defineType(b.observable.DependencyTracker=function(a,b){this.callbackTarget_=b;this.callback_=a;this.subscribers_=null},{dispose:function(){this.resetSubscribers(null);this.callback_=this.callbackTarget_=null},resetSubscribers:function(a){if(this.subscribers_)for(var b=0,c=this.subscribers_.length;b<c;b++)null!==this.subscribers_[b]&&this.subscribers_[b].dispose();
this.subscribers_=a},beginCapture:function(){c.push(d);d={tracker:this,subscribers:[]}},endCapture:function(){if(!(d&&d.tracker===this))throw Error("Tracker does not have capture.");this.resetSubscribers(d.subscribers);d=c.pop()}},{registerDependency:function(b,c){if(null!==d&&-1===a(d.subscribers,b,c)){var g=d.tracker,h=a(g.subscribers_,b,c);-1!==h?(d.subscribers.push(g.subscribers_[h]),g.subscribers_[h]=null):d.subscribers.push(b.subscribe(d.tracker.callback_,d.tracker.callbackTarget_,c))}}})})();
b.observable.model.Extension=function(){};b.defineType(b.observable.model.Extension,{define:function(){},beforeChange:function(){},afterChange:function(){}});provide("photon.binding");(function(){var a={},c=[],d,e={$dataContext:function(a){return(a=d.get(a))?a.getValue():null},$imports:{photon:b},$metaData:b.observable.model.metaData};b.extend(b.binding,{getBindingTagNames:function(){return c},getBindingType:function(b){return a[b]},registerBindingType:function(d,e){-1===b.array.indexOf(c,d)&&c.push(d);
a[d]=e},evaluateInContext:function(a,c,h,i,j,u){b.isNullOrUndefined(h)||h.beginCapture();d=a;try{return c(e,a.getValue(),i,j,u)}finally{d=null,b.isNullOrUndefined(h)||h.endCapture()}},updateBindings:function(a){if(b.isDocumentOrElement(a)){var c=b.binding.BindingContext.getInstance();b.templating.prepareFlowTemplates(a);b.binding.forEachBoundElement(a,b.binding.getBindingTagNames(),function(a,d,e){for(var d=c.parseBindingExpressions(d,e),e=[],f=[],k=0,l=d.length;k<l;k++){var n=d[k],p=b.binding.NodeBindingInfo.getOrCreateForElement(a),
s=p.getBindingByExpression(n);s||(s=d[k].createBinding(a),p.addBinding(s));n instanceof b.binding.data.DataBindingExpression&&"data"===n.getPropertyType()&&"context"===n.getPropertyName()?f.push(s):e.push(s)}b.array.forEach(f,function(a){a.bind()});b.array.forEach(e,function(a){a.beginInitialize()});b.array.forEach(e,function(a){a.bind()});b.array.forEach(e,function(a){a.endInitialize()})})}},applyBindings:function(a,c,d,e){b.isString(c)&&(e=d,d=c,c=void 0);b.isString(d)||(e=d,d=void 0);c||(c=document.body);
if(b.isDocumentOrElement(c)){var j=b.binding.NodeBindingInfo.getOrCreateForElement(c).getOrCreateDataContext();j.setParent(e||b.binding.DataContext.getForElement(c.parentNode));j.setSource(a);j.setName(d);b.binding.updateBindings(c)}},registerImport:function(a,b){e.$imports[a]=b}})})();b.defineType(b.binding.BindingType=function(){},{getDefaultExpressionType:function(){throw b.errors.notImplemented();},getExpressionBuilderType:function(){throw b.errors.notImplemented();}},{getBindingType:function(a){return a instanceof
b.binding.BindingType?a:b.binding.getBindingType(a)}});b.defineType(b.binding.BindingBase=function(a,b){this.target_=a;this.expression_=b},{dispose:function(){this.target_=null;this.setDataContext(null)},getTarget:function(){return this.target_},beginInitialize:function(){this.isInitializing_=!0},endInitialize:function(){this.isInitializing_=!1},getExpression:function(){return this.expression_},getDataContext:function(){return this.dataContext_},getDataSource:function(){return this.dataSource_},setDataContext:function(a){var b=
this.dataContext_;b!==a&&(b&&b.removeSubscriber(this),a&&a.addSubscriber(this),this.dataContext_=a,this.dataContextChanged())},dataContextValueChanged:function(){this.updateDataSource()},dataContextChanged:function(){this.updateDataSource()},updateDataContext:function(){this.target_.parentNode&&this.setDataContext(b.binding.DataContext.getForElement(this.getTarget()))},updateDataSource:function(){if(null!==this.dataContext_){var a=this.dataContext_.getValue();a!==this.dataSource_&&(this.dataSource_=
a,this.dataSourceChanged())}},dataSourceChanged:function(){}});b.binding.BindingExpression=function(a,b){this.createBinding_=a;this.text_=b};b.defineType(b.binding.BindingExpression,{getText:function(){return this.text_},createBinding:function(a){return new this.createBinding_(a,this)}});(function(){b.binding.BindingExpressionBuilder=function(a,b){this.type_=a;this.subtype_=b};b.defineType(b.binding.BindingExpressionBuilder,{getSourceOrThrow:function(){var a=this.getSource();if(!a)throw Error("Binding does not contain a valid source expression.");
return a},setSource:function(a){this.source_=a},getSource:function(){return this.source_},getType:function(){return this.type_},getSubType:function(){return this.subtype_},getText:function(){return this.text_},setText:function(a){this.text_=b.string.trim(a)},makeGetter:function(a){return b.functions.makeScoped(b.string.format("return ($imports.photon.observable.model.isPropertyAccessor({0})) ? {0}() : {0};",a),["$context","$data"])},makeSetter:function(a){return b.functions.makeScoped(b.string.format("if ($imports.photon.observable.model.isPropertyAccessor({0})) {0}({1}); else {0} = {1};",
a,"$value"),["$context","$data"],["$context","$data","$value"])},makeAction:function(a,c){return b.functions.makeScoped(a,["$context","$data"],["$context","$data"].concat(c||[]))}})})();b.defineType(b.binding.BindingContext=function(){this._cache={};this._bindingExpressionCache={}},{nextId_:0,identity:function(a){var b=a["photon.identity"];b||(b=this.nextId_++,a["photon.identity"]=b);this._cache[b]=a;return b},parseBindingExpressions:function(a,c){var a=b.binding.BindingType.getBindingType(a),d=a+
"-"+c;return this._bindingExpressionCache[d]||(this._bindingExpressionCache[d]=(new b.binding.ExpressionParser(a,c)).readAllRemaining())},lookup:function(a){return this._cache[a]}});b.binding.BindingContext.getInstance=function(){return b.binding.BindingContext.instance_||(b.binding.BindingContext.instance_=new b.binding.BindingContext)};(function(){var a=function(a){return b.string.isWhiteSpace(a)||","===a},c=/^[\_$a-z][\_$a-z0-9]*(\(\))?(\[.*?\])*(\(\))?(\.[\_$a-z][\_$a-z0-9]*(\(\))?(\[.*?\])*(\(\))?)*$/i;
b.defineType(b.binding.ExpressionParser=function(a,c){this.tokenizer_=new b.binding.ExpressionTokenizer(c);this.bindingType_=b.isString(a)?b.binding.getBindingType(a):a},{readExpression_:function(a){for(var a=a||"",e,f=0,g=0,h=this.tokenizer_,i=h.getPosition()-h.currentToken().length;(e=this.tokenizer_.currentToken())&&(g||!(","===e||"}"===e||e===a));)f+=e.length,-1!=="{([".indexOf(e)?g++:-1!==")}]".indexOf(e)&&g--,h.nextToken();a=b.string.trim(h.getText().substring(i,i+f));return!e&&!a?null:{text:a,
isWritable:c.test(a)&&")"!==a.charAt(a.length-1)}},getExpressionBuilder:function(a){a=a.split("-",2);1===a.length&&a.unshift(this.bindingType_.getDefaultExpressionType());return new (this.bindingType_.getExpressionBuilderType(a[0]))(a[0],a[1])},readNext:function(){var c,e,f=0,g=this.tokenizer_,h=g.getPosition();h&&h--;if("{"===(c=g.skipWhiteSpace()))c=g.skipWhiteSpace(!0);for(var i,j;c;){j=null;0===f?(j=this.readExpression_(":"),(c=g.currentToken())&&","!==c&&"{"!==c?(e=j.text,j=null):e=this.bindingType_.getDefaultExpressionType(null),
i=this.getExpressionBuilder(e)):(e=b.string.trim(c),c=g.nextToken());null===j&&(":"!==g.skipWhiteSpace()&&this.throwUnexpectedToken(":"),g.nextToken(),j=this.readExpression_(),c=g.currentToken());if(0===f++)i.setSource(j);else{var u="set-"+e;if(!b.isFunction(i[u]))throw Error(b.string.format("Unsupported binding property {0}.",e));i[u](j.text)}e=!c||"}"===c;i.setText(g.getText().substring(h,g.getPosition()));!e&&","!==c&&this.throwUnexpectedToken(",");c=g.skipWhile(a,!0);if(e)break}return i?i.build():
null},throwUnexpectedToken:function(a){var c=this.tokenizer_.currentToken();throw Error(b.string.format("Unexpected token at or near position {0}, expected: '{1}', actual: '{2}.', expression'{3}'",this.tokenizer_.getPosition()-c.length,a,c?c:"EOF",this.tokenizer_.getText()));},readAllRemaining:function(){for(var a=[],b;b=this.readNext();)a.push(b);return a}})})();(function(){var a={"{":"{","}":"}","(":"(",")":")",",":",",".":".",":":":",";":";","[":"[","]":"]"};b.binding.ExpressionTokenizer=function(c){var d=
0,e;this.getText=function(){return c};this.getPosition=function(){return d};this.currentToken=function(){return e};this.nextToken=function(){for(var b=d,g;g=c.charAt(d);){if(a.hasOwnProperty(g)){if(d>b)break;d++;return e=g}if('"'===g||"'"===g){if(d>b)break;d++;for(var h=g;g=c.charAt(d++);){if(g===h)return e=c.substring(b,d);"\\"===g&&d++}throw Error("Syntax error, unterminated string literal.");}d++}return d>b?e=c.substring(b,d):e=""};this.skipWhiteSpace=function(a){return this.skipWhile(b.string.isWhiteSpace,
a)};this.readWhile=function(a,b){for(var h=0,i=d,j=b||!i?this.nextToken():e;j&&a(j);)h+=(j=this.nextToken()).length;return 0<h?c.substring(i,i+h):""};this.skipWhile=function(a,b){for(var c=b||!d?this.nextToken():e;c&&a(c);)c=this.nextToken();return c}}})();provide("photon.binding.data");b.binding.data.DataBindingMode={Default:0,OneWay:1,TwoWay:2,OneTime:3};b.binding.data.DataBinding=function(a,c){b.binding.data.DataBinding.base(this,a,c)};b.defineType(b.binding.data.DataBinding,b.binding.BindingBase,
{dispose:function(){this.superType.dispose.call(this);this.dependencyTracker_&&(this.dependencyTracker_.dispose(),this.dependencyTracker_=null)},beginInitialize:function(){b.binding.data.DataBinding.superType.beginInitialize.call(this);this.getExpression().getPropertyHandler().beginInitialize(this)},endInitialize:function(){b.binding.data.DataBinding.superType.endInitialize.call(this);this.getExpression().getPropertyHandler().endInitialize(this)},bindUpdateSourceEvent:function(a){b.isArray(a)&&(a=
a.join(" "));k(this.target_).bind(a,this,this.targetChanged)},targetChanged:function(a){a.data.updateSource(a)},updateSource:function(){var a=this.getExpression();a.setSourceValue(this.getDataContext(),null,a.getPropertyHandler().getValue(this))},getSourceValue:function(){return this.getExpression().getSourceValue(this.getDataContext(),this.dependencyTracker_)},getBindingMode:function(){var a=this.expression_.getMode()||b.binding.data.DataBindingMode.Default,c=this.getExpression().getPropertyHandler();
a===b.binding.data.DataBindingMode.Default&&(a=c.getDefaultBindingMode?c.getDefaultBindingMode(this):b.binding.data.DataBindingMode.OneWay);return a},dataSourceChanged:function(){this.updateSourceValue(this.dependencyTracker_)},updateSourceValue:function(a){a=this.getExpression().getSourceValue(this.getDataContext(),a);this.sourceValue_!==a&&(this.sourceValue_=a,this.sourceValueChanged())},sourceValueChanged:function(){this.getExpression().getPropertyHandler().setValue(this)},ensureInitialized:function(){this.isInitialized_||
(this.dependencyTracker_=new b.observable.DependencyTracker(function(){this.updateSourceValue(null)},this),b.addDisposable(this.target_,this.dependencyTracker_),this.getBindingMode()===b.binding.data.DataBindingMode.TwoWay&&this.expression_.getPropertyHandler().bindUpdateSourceTriggers(this),this.isInitialized_=!0)},bind:function(){this.ensureInitialized();var a=this.getExpression();if("data"===a.getPropertyType()&&"context"===a.getPropertyName()){var c=this.getTarget(),d=b.binding.DataContext.getLocalForElement(c);
d&&!d.isInherited?(d.setName(a.getName()),d.setBinding(this)):(d=b.binding.NodeBindingInfo.getOrCreateForElement(c).getOrCreateDataContext(),d.setName(a.getName()),d.setParent(b.binding.DataContext.getForElement(c.parentNode)),d.isInherited=!0,this.setDataContext(d.getParent()))}else this.updateDataContext()}});b.binding.data.DataBindingExpression=function(a,c,d,e,f,g,h,i){b.binding.data.DataBindingExpression.base(this,b.binding.data.DataBinding,a);this.propertyType_=c;this.propertyName_=d;this.getter_=
e;this.setter_=f;this.mode_=g;this.name_=h;this.isPrimary_=i;this.propertyHandler_=r(b.binding.data.properties[c+"."+d]||b.binding.data.properties[c],"Unsupported data binding type'{0}'",c)};b.defineType(b.binding.data.DataBindingExpression,b.binding.BindingExpression,{getName:function(){return this.name_},getMode:function(){return this.mode_},getIsPrimary:function(){return this.isPrimary_},getGetter:function(){return this.getter_},getSetter:function(){return this.setter_},getPropertyHandler:function(){return this.propertyHandler_},
getPropertyType:function(){return this.propertyType_},getPropertyName:function(){return this.propertyName_},getSourceValue:function(a,c){return b.binding.evaluateInContext(a,this.getter_,c)},setSourceValue:function(a,c,d){return b.binding.evaluateInContext(a,this.setter_,c,d)}});(function(){var a={$imports:{photon:b}};b.binding.data.DataBindingExpressionBuilder=function(a,d){b.binding.data.DataBindingExpressionBuilder.base(this,a,d)};b.defineType(b.binding.data.DataBindingExpressionBuilder,b.binding.BindingExpressionBuilder,
{build:function(){var c=this.getSourceOrThrow();b.isUndefined(this.mode_)&&(this.mode_=b.binding.data.DataBindingMode.Default);c.isWritable||(r(this.mode_!==b.binding.data.DataBindingMode.TwoWay,"Binding mode is TwoWay, but the source expression is not writable."),this.mode_===b.binding.data.DataBindingMode.Default&&(this.mode_=b.binding.data.DataBindingMode.OneWay));var d=this.makeGetter(c.text),e=this.convertFrom_,f;if(this.isWritableMode_(this.mode_)&&c.isWritable){var g=this.makeSetter(c.text),
h=this.convertTo_;f=function(b,c,d){if(arguments.length<3){d=c;c=b;b=a}h&&(d=h(d));g(b||a,c,d)}}return new b.binding.data.DataBindingExpression(this.getText(),this.getType(),this.getSubType(),function(b,c){if(c===void 0){c=b;b=a}var f=d(b,c);e&&(f=e(f));return f},f,this.mode_,this.name_,this.isPrimary_)},"set-mode":function(a){r(b.binding.data.DataBindingMode.hasOwnProperty(a),"Invalid binding mode '{0}'.",a);this.mode_=b.binding.data.DataBindingMode[a]},"set-name":function(a){this.name_=a},"set-convertFrom":function(a){this.convertFrom_=
this.getConverter_(a)},"set-convertTo":function(a){this.convertTo_=this.getConverter_(a)},"set-isPrimary":function(a){this.isPrimary_=b.object.toBoolean(a)},isWritableMode_:function(a){return a===b.binding.data.DataBindingMode.Default||a===b.binding.data.DataBindingMode.TwoWay},getConverter_:function(a){return new Function("$value","return "+a)}})})();b.binding.data.DataBindType=function(){};b.defineType(b.binding.data.DataBindType,b.binding.BindingType,{getDefaultExpressionType:function(){return"property"},
getExpressionBuilderType:function(){return b.binding.data.DataBindingExpressionBuilder}});b.binding.registerBindingType("data-bind",new b.binding.data.DataBindType);b.defineType(b.binding.data.Property=function(){},{beginInitialize:function(){},endInitialize:function(){},getDefaultBindingMode:function(){return b.binding.data.DataBindingMode.OneWay},getValue:function(a){return a.getTarget()[a.getExpression().getPropertyName()]},setValue:function(a){a.getTarget()[a.getExpression().getPropertyName()]=
a.getSourceValue()}});b.defineType(b.binding.data.InputProperty=function(){},b.binding.data.Property,{getDefaultBindingMode:function(){return b.binding.data.DataBindingMode.TwoWay},bindUpdateSourceTriggers:function(a){a.bindUpdateSourceEvent("change")}});b.defineType(b.binding.data.FocusProperty=function(){},b.binding.data.Property,{bindUpdateSourceTriggers:function(a){a.bindUpdateSourceEvent("focus blur")},getDefaultBindingMode:function(){return b.binding.data.DataBindingMode.TwoWay},getValue:function(a){return b.dom.hasFocus(a.getTarget())},
setValue:function(a){b.dom.hasFocus(a.getTarget(),a.getSourceValue())}});b.defineType(b.binding.data.StyleProperty=function(){},b.binding.data.Property,{getValue:function(a){return k(a.getTarget()).css(a.getExpression().getPropertyName())},setValue:function(a){k(a.getTarget()).css(a.getExpression().getPropertyName(),a.getSourceValue())}});b.defineType(b.binding.data.DataContextProperty=function(){},b.binding.data.Property,{getValue:function(a){return b.binding.DataContext.getForElement(a.getTarget()).getSource()},
setValue:function(a){b.binding.DataContext.getForElement(a.getTarget()).setSource(a.getSourceValue())}});b.defineType(b.binding.data.AttributeProperty=function(){},b.binding.data.Property,{getValue:function(a){a.getTarget().getAttribute(a.getExpression().getPropertyName())},setValue:function(a){a.getTarget().setAttribute(a.getExpression().getPropertyName(),a.getSourceValue())}});b.defineType(b.binding.data.DataTemplateProperty=function(){},b.binding.data.Property,{getValue:function(a){return a.template},
templatesEqual:function(a,c){return a===c||b.isNullOrUndefined(a)&&b.isNullOrUndefined(c)?!0:b.isNullOrUndefined(a)||b.isNullOrUndefined(c)?!1:a.name===c.name&&a.data===c.data&&a.each===c.each},getFragment:function(a){var c=b.templating.getCache(),d=c.findFragment(a);d||(c.addElement(a),d=c.findFragment(a));return d},collectionChanged:function(a){this.setValue(a.data,!0)},setValue:function(a,c){var d=a.template,e=a.getSourceValue();if(c||!this.templatesEqual(d,e)){a.template=e;var d=a.getTarget(),
f=this.getFragment(e.name),g=b.binding.DataContext.getForElement(d);if(e.each){if(!a.renderer_||!a.renderer_.getReferenceElement())a.renderer_=new b.templating.ItemsRenderer(d,b.templating.RenderTarget.NextSibling,b.templating.getCache().getTemplate(e.name)),b.addDisposable(d,a.renderer_);a.renderer_.setData(e.each)}else b.dom.empty(d),b.templating.insertBeforeAndApplyBindings(d,f,null,e.data,g)}}});b.defineType(b.binding.data.ClassProperty=function(){},b.binding.data.Property,{getDefaultBindingMode:function(){return b.binding.data.DataBindingMode.OneWay},
getValue:function(a){var b=a.getExpression().getPropertyName(),b=Number(b);return isNaN(b)?k(a.getTarget()).hasClass(a.getExpression().getPropertyName()):a.cssClasses_&&a.cssClasses_[b]},setValue:function(a){var b=a.getSourceValue(),d=a.getExpression().getPropertyName(),e=k(a.getTarget()),f=Number(d);if(isNaN(f))b?e.addClass(d):e.removeClass(d);else{a.cssClasses_=a.cssClasses_||[];var g=a.cssClasses_[f];g!=b&&(g&&e.removeClass(g),a.cssClasses_[f]=d,b&&e.addClass(b))}}});b.defineType(b.binding.data.TextProperty=
function(){},b.binding.data.Property,{getValue:function(a){return k(a.getTarget()).text()},setValue:function(a){k(a.getTarget()).text(a.getSourceValue())}});provide("photon.binding.data.properties");b.extend(b.binding.data.properties,{"null":{},property:new b.binding.data.Property,"property.value":new b.binding.data.InputProperty,"property.checked":new b.binding.data.InputProperty,"property.focus":new b.binding.data.FocusProperty,"property.text":new b.binding.data.TextProperty,style:new b.binding.data.StyleProperty,
attribute:new b.binding.data.AttributeProperty,"data.context":new b.binding.data.DataContextProperty,"data.template":new b.binding.data.DataTemplateProperty,"class":new b.binding.data.ClassProperty});provide("photon.binding.actions");b.defineType(b.binding.actions.ActionBinding=function(a,c){b.binding.actions.ActionBinding.base(this,a,c)},b.binding.BindingBase,{onTriggered_:function(a){a.data.invoke(a)},bind:function(){this.isInitialized_||(b.events.add(this.getTarget(),this.getExpression().getEvents(),
this,this.onTriggered_),this.isInitialized_=!0);this.setDataContext(b.binding.DataContext.getForElement(this.getTarget()))},invoke:function(a){var c=this.getExpression();c.getStopPropagation()&&a.stopPropagation();c.getPreventDefault()&&a.preventDefault();b.binding.evaluateInContext(this.dataContext_,c.getAction(),null,a)}});b.defineType(b.binding.actions.ActionBindingExpression=function(a,c,d,e,f){b.binding.actions.ActionBindingExpression.base(this,b.binding.actions.ActionBinding,a);this.action_=
c;d||(d="click");this.events_=d.split(/\W+/).join(".photon ")+".photon";this.stopPropagation_=b.isUndefined(e)?!1:e?!0:!1;this.preventDefault_=b.isUndefined(f)?!1:f?!0:!1},b.binding.BindingExpression,{getAction:function(){return this.action_},getStopPropagation:function(){return this.stopPropagation_},getPreventDefault:function(){return this.preventDefault_},getEvents:function(){return this.events_}});b.defineType(b.binding.actions.ActionBindingExpressionBuilder=function(a,c,d){b.binding.actions.ActionBindingExpressionBuilder.base(this,
a,c,d)},b.binding.BindingExpressionBuilder,{build:function(){var a=this.getSource();if(!a)throw Error("Binding does not contain a valid source expression.");var c=this.makeAction(a.text,["$event"]);return new b.binding.actions.ActionBindingExpression(this.getText(),function(a,b,f){c(a||{},b,f)},this.events_,this.stopPropagation_,this.preventDefault_)},"set-stopPropagation":function(a){this.stopPropagation_=b.object.toBoolean(a)},"set-preventDefault":function(a){this.preventDefault_=b.object.toBoolean(a)},
"set-events":function(a){this.events_=a}});b.defineType(b.binding.actions.ActionBindingType=function(){},b.binding.BindingType,{getDefaultExpressionType:function(){return"action"},getExpressionBuilderType:function(){return b.binding.actions.ActionBindingExpressionBuilder}});b.binding.registerBindingType("data-action",new b.binding.actions.ActionBindingType);provide("photon.binding.flow");b.binding.flow.FlowBinding=function(a,c){b.binding.flow.FlowBinding.base(this,a,c);b.addDisposable(a,this);this.renderer_=
"if"===this.getExpression().getFlowType()?new b.templating.ConditionalRenderer(a,this.getExpression().getApplyTo(),b.templating.FlowTemplate.getForElement(a)):new b.templating.ItemsRenderer(a,this.getExpression().getApplyTo(),b.templating.FlowTemplate.getForElement(a))};b.defineType(b.binding.flow.FlowBinding,b.binding.BindingBase,{dispose:function(){this.superType.dispose.call(this);this.renderer_&&(this.renderer_.dispose(),this.renderer_=null)},dataSourceChanged:function(){this.getDataContext()?
this.updateFlowData(this.dependencyTracker_):this.renderer_.setData(void 0)},updateFlowData:function(a){this.renderer_.setData(this.getExpression().getFlowData(this.getDataContext(),a))},bind:function(){this.isInitialized_||(this.dependencyTracker_=new b.observable.DependencyTracker(function(){this.updateFlowData(this.dependencyTracker_)},this),b.addDisposable(this.target_,this.dependencyTracker_),this.isInitialized_=!0);this.updateDataContext()}});b.binding.flow.FlowBindingExpression=function(a,
c,d,e){b.binding.flow.FlowBindingExpression.base(this,b.binding.flow.FlowBinding,a);this.flowType_=c;this.applyTo_=b.isNullOrUndefined(e)?b.templating.RenderTarget.Child:e;this.getFlowData_=d};b.defineType(b.binding.flow.FlowBindingExpression,b.binding.BindingExpression,{getFlowType:function(){return this.flowType_},getFlowData:function(a,c){return b.binding.evaluateInContext(a,this.getFlowData_,c)},getApplyTo:function(){return this.applyTo_}});b.binding.flow.FlowBindingExpressionBuilder=function(a,
c){b.binding.flow.FlowBindingExpressionBuilder.base(this,a,c)};b.defineType(b.binding.flow.FlowBindingExpressionBuilder,b.binding.BindingExpressionBuilder,{build:function(){var a=this.makeGetter(this.getSourceOrThrow().text);return new b.binding.flow.FlowBindingExpression(this.getText(),this.getSubType(),a,this.applyTo_)},"set-applyTo":function(a){r(b.templating.RenderTarget.hasOwnProperty(a),"Invalid applyTo value '{0}'.",a);this.applyTo_=b.templating.RenderTarget[a]}});b.binding.flow.FlowBindingType=
function(){};b.defineType(b.binding.flow.FlowBindingType,b.binding.BindingType,{getDefaultExpressionType:function(){return"flow"},getExpressionBuilderType:function(){return b.binding.flow.FlowBindingExpressionBuilder}});b.binding.registerBindingType("data-flow",new b.binding.flow.FlowBindingType);b.dom.subscribeToCleanup(function(a){if((a=b.getData(a))&&a.disposables)for(var c=0,d=a.disposables.length;c<d;c++)a.disposables[c].dispose()});b.addDisposable=function(a,c){var d=b.getOrCreateData(a);(d.disposables=
d.disposables||[]).push(c)};b.rewriteTemplate=function(a){return a.replace(/(<[a-z]([a-z]|\d)*(\s+(?!data-context=('templateSource[^']*'|"templateSource[^']*"))[a-z0-9\-]+(=("[^"]*"|'[^']*'))?)*\s+(data-context=((["'])templateSource:([\s\S]*?))\9))/gi,function(){var a=arguments.length,d=new b.StringBuilder,e=arguments[0];d.push(e.substring(0,e.length-arguments[a-6].length));d.push("data-context-id=");e=arguments[a-4];d.push(e);b.rewriteScriptFragment(d,"=context.identity("+arguments[a-3]+")");d.push(e);
return d.get()})};b.rewriteScriptFragment=function(a,b){a.pushAll(["<%",b,"%>"])};b.getOrCreateData=function(a){return a.photonData||(a.photonData={})};b.getData=function(a){return a.photonData};(function(){var a=document.querySelectorAll?function(a,d,e){var f="*["+d.join("], *[")+"]";if(1===a.nodeType)for(var g=0,h=d.length;g<h;g++){var i=d[g],j=a.getAttribute(i);j&&e(a,i,j)}b.array.forEach(a.querySelectorAll(f),function(a){for(var b=0,c=d.length;b<c;b++){var f=d[b],g=a.getAttribute(f);g&&e(a,f,
g)}})}:function(a,b,e){if(1===a.nodeType)for(var f=0,g=b.length;f<g;f++){var h=b[f],i=a.getAttribute(h);i&&e(a,h,i)}for(var a=a.getElementsByTagName("*"),j=0,k=a.length;j<k;j++)for(var l=a[j],f=0,g=b.length;f<g;f++)h=b[f],(i=l.getAttribute(h))&&e(l,h,i)};b.binding.forEachBoundElement=function(c,d,e){if(c=c||document)b.isString(d)&&(d=[d]),a(c,d,e)}})();var J={},G=[],O={"&amp;":"&","&quot;":'"',"&lt;":"<","&gt;":">"};provide("photon.templating",{getBindingExpressionsFromHtml:function(a,c){a=N(a);c=
c||"data-bind";r(b.binding.getBindingType(c));var d=J[c];d?d.lastIndex=0:d=J[c]=RegExp(b.string.format("(<[a-z]([a-z]|\\d)*(\\s+(?!{0}=)[a-z0-9\\-]+(=(\"[^\"]*\"|'[^']*'))?)*\\s+({0}=([\"'])([\\s\\S]*?)\\7))",c),"gi");for(var e=b.binding.BindingContext.getInstance(),f,g=[];f=d.exec(a);)Array.prototype.push.apply(g,e.parseBindingExpressions(c,f[f.length-1]));return g},getPrimaryDataBindingExpressionFromHtml:function(a){a=b.templating.getBindingExpressionsFromHtml(a,"data-bind");1<a.length&&(a=b.array.filter(a,
function(a){return a.isPrimary}));return 1===a.length?a[0]:null},afterRender:function(a){var b=G;if(0<b.length)for(var d=0,e=b.length;d<e;d++)b[d](a)},registerAfterRender:function(a){var b=G.slice(0);b.push(a);G=b},getHtml:function(a,c,d){var e=b.isString(a)?a:a.name,f=C.findHtml(e);f?c&&c.call(d,{template:f,completedSynchronously:!0}):a.url&&C.addResourceUrl(a.url,function(a){c&&c.call(d,{template:C.findHtml(e),completedSynchronously:a.completedSynchronously})});return f},insertBefore:function(a,
c,d,e){var f=[];if(b.isDocumentFragment(c))for(var g=c.childNodes,h=0,i=g.length;h<i;h++)f[h]=g[h];else f[0]=c;a.insertBefore(c,d);b.array.forEach(f,function(a){b.isDocumentOrElement(a)&&(a.parentDataContextNode=e,b.binding.updateBindings(a))});b.templating.afterRender(f);return f},insertBeforeAndApplyBindings:function(a,c,d,e,f){var g=[];if(b.isDocumentFragment(c))for(var h=c.childNodes,i=0,j=h.length;i<j;i++)g.push(h[i]);else g.push(c);a.insertBefore(c,d);b.array.forEach(g,function(a){b.isDocumentOrElement(a)&&
b.binding.applyBindings(e,a,f)});b.templating.afterRender(g);return g}});b.defineType(b.templating.TemplateCache=function(){this.templates_={}},{resourceDelimiterRegEx:/<\!--\s*Template:\s*([\w\.]*)\s*--\>/,getTemplate:function(a){return r(this.templates_[a],"No template could be found with key '{0}'.",a)},findTemplate:function(a){return this.templates_[a]},remove:function(a){var b=this.templates_[a];b&&b.dispose();return delete this.templates_[a]},clear:function(){b.array.forEach(b.object.getOwnPropertyNames(this.templates_),
function(a){this.remove(a)},this)},getFragment:function(a){return this.getTemplate(a).getFragment()},findFragment:function(a){return(a=this.templates_[a])?a.getFragment():null},getHtml:function(a){return this.getTemplate(a).getHtml()},findHtml:function(a){return(a=this.templates_[a])?a.template:null},addHtml:function(a,c){this.remove(a);var d=b.dom.wrap(b.dom.htmlToFragmentOrNode(c),"div"),e=b.templating.prepareFlowTemplates(d),f=new b.templating.Template(null,a);0<e.length?(f.setTemplate(d.innerHTML),
b.array.forEach(e,function(a){this.addChild(a)},f)):f.setTemplate(c);this.templates_[a]=f},addElement:function(a,c){var d=b.isElement(a)?a:document.getElementById(a);r(d,"Invalid element specification {0}.",a);r(c?c:c=d.id,"A name must be specified if the element does not have an id.");this.addHtml(c,d.innerHTML)},addResourceElement:function(a,c){var d=b.isElement(a)?a:document.getElementById(a);r(d,"Invalid element specification {0}.",a);this.addResourceHtml(c||d.id,d.innerHTML)},addResourceHtml:function(a,
c,d){c=b.string.trim(c);c=b.string.split(c,d||this.resourceDelimiterRegEx);if(1===c.length)this.addHtml(a,c[0]);else for(var a=a?a+".":"",d=c[0]?0:1,e=c.length;d<e&&d!==e;d+=2)this.addHtml(a+c[d],b.string.trim(c[d+1]))},addResourceUrl:function(a,c,d){function e(a){i.isSuccess=i.isSuccess&&a;!--j&&c&&(i.completedSynchronously=h,c(i))}function f(a){k.ajax({type:"GET",url:a}).done(function(a){var b=!0;try{k(a).filter("script").each(function(a,b){g.addResourceHtml(b.id,k(b).html(),d)})}catch(f){if(b=
!1,!c)throw f;}e(b)}).fail(function(){e(!1)})}var g=this;b.isArray(a)||(a=[a]);for(var h=!0,i={isSuccess:!0},j=a.length,l=0,r=j;l<r;l++)f(a[l]);h=!1}});var C=new b.templating.TemplateCache;b.templating.getCache=function(){return C};b.defineType(b.templating.Template=function(a,b){this.parent_=null;a&&a.addChild(this);b&&(this.key_=b)},{dispose:function(){var a=this.children_;if(a)for(var b=0,d=a.length;b<d;b++)a[b].dispose()},getKey:function(){return this.key_},addChild:function(a){a.parent_=this;
var b=this.children_;b?b.push(a):this.children_=[a]},getChild:function(a){return this.children_?this.children_[a]:0},getChildCount:function(){return this.children_?this.children_.length:0},getParent:function(){return this.parent_},setTemplate:function(a){if(this.html_||this.fragment_)throw Error("Template cannot be modified once set.");b.isDocumentFragment(a)?this.fragment_=a:this.html_=a},getHtml:function(){if(!this.html_){if(!this.fragment_)return null;this.html_=b.dom.getHtml(this.fragment_)}return this.html_},
getFragment:function(){if(!this.fragment_){if(!this.html_)return this.fragment_=document.createDocumentFragment();var a=b.dom.htmlToFragmentOrNode(this.html_),c=a;b.isDocumentFragment(a)||(c=document.createDocumentFragment(),c.appendChild(a));this.fragment_=c}return this.fragment_.cloneNode(!0)},insertBefore:function(a,c,d){return b.templating.insertBefore(a,this.getFragment(),c,d)}});var D={},K=0;b.defineType(b.templating.FlowTemplate=function(a){D[++K]=this;b.templating.FlowTemplate.base(this,a,
K)},b.templating.Template,{dispose:function(){var a=this.key_;a&&(b.templating.FlowTemplate.superType.dispose.call(this),delete D[a],delete this.key_)}},{getForElement:function(a){return D[a.getAttribute("data-template-id")]}});b.templating.prepareFlowTemplates=function(a){var b=[];1===a.nodeType&&a.getAttribute("data-flow")&&!a.getAttribute("data-template-id")&&H(b,a,a);k("*[data-flow]:not(*[data-template-id])",a).each(function(d,e){H(b,e,a)});for(var d=0,e=b.length;d<e;d++)I(b[d]);return b};b.templating.getFlowTemplateCache_=
function(){return D};b.dom.subscribeToCleanup(function(a){if(b.isElement(a)){var c=a.flowTemplate_;c&&(c.getParent()||c.dispose(),a.flowTemplate_=void 0)}});var L=function(a){this.pool_=[];this.poolIndex_=0;this.template_=a};b.defineType(L,{addToPool:function(a){this.pool_.push(a);b.array.forEach(a,b.dom.remove)},getFragment:function(){if(this.poolIndex_<this.pool_.length){var a=this.pool_[this.poolIndex_++];if(1===a.length)return a[0];for(var b=document.createDocumentFragment(),d=0,e=a.length;d<
e;d++)b.appendChild(a[d]);return b}return this.template_.getFragment()},dispose:function(){for(var a=this.poolIndex_,c=this.pool_.length;a<c;a++)b.dom.cleanNodes(this.pool_[a]);this.pool_=this.poolIndex_=void 0}});b.templating.Renderer=function(a,b,d){this.referenceElement_=a;this.renderTarget_=b;this.template_=d};b.defineType(b.templating.Renderer,{dispose:function(){this.referenceElement_=this.data_=this.template_=void 0},getReferenceElement:function(){return this.referenceElement_},setData:function(a,
b){this.data_!==a?(this.data_=a,this.onDataChanged()):b&&this.refresh()},getData:function(){return this.data_},onDataChanged:function(){this.refresh()},refresh:function(){}});b.templating.ConditionalRenderer=function(a,c,d){b.templating.ConditionalRenderer.base(this,a,c,d)};b.defineType(b.templating.ConditionalRenderer,b.templating.Renderer,{refresh:function(){var a=this.renderedNodes_,c=this.referenceElement_;this.data_?a||(this.renderedNodes_=this.renderTarget_===b.templating.RenderTarget.Child?
this.template_.insertBefore(c,null):this.template_.insertBefore(c.parentNode,c.nextSibling,c)):a&&(b.array.forEach(a,b.dom.removeAndClean),this.renderedNodes_=null)}});b.templating.ItemsRenderer=function(a,c,d){b.templating.ItemsRenderer.base(this,a,c,d)};b.defineType(b.templating.ItemsRenderer,b.templating.Renderer,{dispose:function(){this.subscribe_(null);this.superType.dispose.call(this);this.renderedNodes_=null},refresh:function(){if(this.data_){var a=this.data_;this.subscribe_(a);a=b.observable.unwrap(a)||
[];this.render_(this.itemsCopy_||[],a);this.itemsCopy_=a.slice(0)}},subscribe_:function(a){var b=this.subscriber_;b&&b.getOwner()!==a&&(b.dispose(),this.subscriber_=b=null);!b&&a&&a.subscribe&&(this.subscriber_=a.subscribe(this.refresh,this))},render_:function(a,c){this.renderedNodes_=this.renderedNodes_||[];for(var d=b.array.diff(a,c),e,f,g=this.referenceElement_,h=this.renderedNodes_,i,j=0,k=null,l=new L(this.template_),r=this.renderTarget_===b.templating.RenderTarget.Child?g:g.parentNode,n=b.binding.DataContext.getForElement(g),
p=0,s=d.length;p<s;p++){e=d[p];var v=Math.min(e.deletedA,e.insertedB),o=f=e.startA-j;for(i=f+e.deletedA-v;o<i;o++,j++)l.addToPool(h[o]);h.splice(f,e.deletedA-v);for(o=0;o<v;o++)i=h[f++],(i=b.array.find(i,function(a){return null!=b.binding.DataContext.getLocalForElement(a)}))&&b.binding.DataContext.getLocalForElement(i).setSource(c[e.startB+o]);e.startA=f;e.startB+=v;e.insertedB-=v;e.deletedA=0}this.renderTarget_===b.templating.RenderTarget.NextSibling&&(0<h.length?(i=h[h.length-1],k=i[i.length-1].nextSibling):
k=g.nextSibling);for(p=j=0;p<s;p++){e=d[p];f=e.startA+j;g=h[f]?h[f][0]:k;v=e.startB;for(e=v+e.insertedB;v<e;v++,j++)h.splice(f++,0,b.templating.insertBeforeAndApplyBindings(r,l.getFragment(),g,c[v],n))}l.dispose()}});b.templating.RenderTarget={Child:0,NextSibling:1};b.defineType(b.binding.DataContext=function(){this.value_=void 0},{dispose:function(){this.removeFromParent_();delete this.parent_},removeFromParent_:function(){var a=this.parent_;a&&(b.array.remove(a.children_,this),0===a.children_.length&&
delete a.children_)},setParent:function(a){if(!b.isNullOrUndefined(a)&&!a instanceof b.binding.DataContext)throw Error("Value must be of type DataContext.");this.parent_!==a&&(this.removeFromParent_(),a?(this.parent_=a,a.children_?a.children_.push(this):a.children_=[this]):delete this.parent_,this.parentChanged())},getParent:function(){return this.parent_},getChild:function(a){return this.children_?this.children_[a]:null},getSource:function(){return this.source_},setSource:function(a){this.source_!=
a&&(this.source_=a,this.updateValue_())},setBinding:function(a){this.binding_!=a&&(this.binding_=a,this.updateValue_())},getBinding:function(){return this.binding_},updateValue_:function(){var a=this.source_;if(this.binding_){var b=this.value_;this.value_=a;a=this.value_=this.binding_.getExpression().getSourceValue(this);if(b!==a)this.onValueChanged_()}else this.value_!==a&&(this.value_=a,this.onValueChanged_())},getValue:function(){return this.value_},setName:function(a){this.name_=a},getName:function(){return this.name_},
onValueChanged_:function(){var a=this.subscribers_;a&&(a=a.slice(0),b.array.forEach(a,this.notifyValueChanged,this))},addSubscriber:function(a){this.subscribers_?this.subscribers_.push(a):this.subscribers_=[a]},removeSubscriber:function(a){var c=!1;this.subscribers_&&(c=b.array.remove(this.subscribers_,a),0===this.subscribers_.length&&delete this.subscribers_);return c},notifyValueChanged:function(a){a.dataContextValueChanged(this,this.value_)},getChildCount:function(){return this.children_?this.children_.length:
0},parentChanged:function(){},get:function(a){if(0===arguments.length)return this;var c=this;if(b.isString(a))for(;c&&c.getName()!==a;)c=c.parent_;else for(var d=0;d++<a&&c;)c=c.parent_;return c}},{getForElement:function(a){for(;a;a=a.parentDataContextNode||a.parentNode){var b=this.getLocalForElement(a);if(b)return b}return null},getLocalForElement:function(a){if(a=b.binding.NodeBindingInfo.getForElement(a))if(a=a.getDataContext())return a;return null}});b.binding.NodeBindingInfo=function(){};b.defineType(b.binding.NodeBindingInfo,
{dispose:function(){this.dataContext_&&(this.dataContext_.dispose(),this.dataContext=null);this.bindings_&&(b.array.forEach(this.bindings_,function(a){a.dispose()}),this.bindings_=null)},getBindingCount:function(){return this.bindings_?this.bindings_.length:0},getBinding:function(a){return this.bindings_?this.bindings_[a]:null},findBinding:function(a,c){return this.bindings_?b.array.find(this.bindings_,a,c):null},addBinding:function(a){this.bindings_?this.bindings_.push(a):this.bindings_=[a]},getBindingByExpression:function(a){var c=
a;b.isString(a)||(c=a.getText());return this.bindings_?b.array.find(this.bindings_,function(a){return c===a.getExpression().getText()}):null},getDataContext:function(){return this.dataContext_},getOrCreateDataContext:function(){return this.dataContext_?this.dataContext_:this.dataContext_=new b.binding.DataContext}},{getForElement:function(a){return(a=b.getData(a))?a.nodeBindingInfo:null},getOrCreateForElement:function(a){a=b.getOrCreateData(a);if(a.nodeBindingInfo)return a.nodeBindingInfo;a.nodeBindingInfo=
new b.binding.NodeBindingInfo;(a.disposables=a.disposables||[]).push(a.nodeBindingInfo);return a.nodeBindingInfo}});provide("photon.ui");b.defineType(b.ui.Selector=function(a){b.addDisposable(this.target_=a,this);this.items_=null;this.initializeCount_=0;this.evaluationDataContext_=new b.binding.DataContext},{dispose:function(){this.disposeSubscriber_()},disposeSubscriber_:function(){var a=this.subscriber_;a&&(a.dispose(),this.subscriber_=null)},beginInitialize:function(){1===++this.initializeCount_&&
(this.initializeStore_={selectedItem:this.getSelectedItem()})},endInitialize:function(){if(!--this.initializeCount_){var a=this.initializeStore_;this.initializeStore_=null;this.update();this.setSelectedItem(a.selectedItem)}},getInContext:function(a,c,d){var e=a;e||(e=this.evaluationDataContext_,e.setParent(b.binding.DataContext.getForElement(this.target_)),e.setSource(d));try{return b.binding.evaluateInContext(e,c,null)}finally{a||(e.setParent(null),e.setSource(null))}},getDisplay:function(a){return this.displayEvaluator_?
this.getInContext(null,this.displayEvaluator_,a):a?a.toString():""},getValue:function(a){return this.valueEvaluator_?this.getInContext(null,this.valueEvaluator_,a):a},getItem_:function(a){var c=b.observable.unwrap(this.items_);return c?c[a]:void 0},setValueEvaluator:function(a){this.valueEvaluator_!==a&&(this.valueEvaluator_=a)},getValueEvaluator:function(){return this.valueEvaluator_},setDisplayEvaluator:function(a){this.displayEvaluator_!==a&&(this.displayEvaluator_=a,this.update())},getDisplayEvaluator:function(){return this.displayEvaluator_},
getTarget:function(){return this.target_},getItems:function(){return this.items_},setItems:function(a){if(this.items_!==a){this.disposeSubscriber_();if((this.items_=a)&&a.isObservable)this.subscriber_=a.subscribe(this.update,this);this.update()}},update:function(){if(!this.initializeStore_){var a=this.target_,c=this.getSelectedItem();b.dom.empty(this.target_);if(this.items_){var d=b.observable.unwrap(this.items_),e=[],f=0;b.array.forEach(d,function(a){e[f++]="<option>";e[f++]=this.getDisplay(a);e[f++]=
"</option>"},this);k(e.join("")).appendTo(a);a.selectedIndex=this.findIndexByValue(c)}}},getSelectedItem:function(){if(this.initializeStore_)return this.initializeStore_.selectedItem;var a=this.target_.selectedIndex;return-1===a?null:this.getValue(this.getItem_(a))},setSelectedItem:function(a){this.getSelectedItem()!==a&&(this.initializeStore_?this.initializeStore_.selectedItem=a:this.getTarget().selectedIndex=this.findIndexByValue(a))},findIndexByValue:function(a){return this.items_?b.array.findIndex(b.observable.unwrap(this.items_),
function(b){return this.getValue(b)===a},this):-1}});b.defineType(b.ui.SelectorProperty=function(a){this.propertyName_=a},b.binding.data.Property,{getSelector:function(a){var c=b.getOrCreateData(a.getTarget());return c.control=c.control||new b.ui.Selector(a.getTarget())},beginInitialize:function(a){if("SELECT"!==a.getTarget().tagName)throw Error("Expected selector");this.getSelector(a).beginInitialize()},endInitialize:function(a){this.getSelector(a).endInitialize()},getValue:function(a){return this.getSelector(a)["get"+
this.propertyName_]()},setValue:function(a){this.getSelector(a)["set"+this.propertyName_](a.getSourceValue())}});b.defineType(b.ui.SelectorItemsProperty=function(){b.ui.SelectorItemsProperty.base(this,"Items")},b.ui.SelectorProperty);b.defineType(b.ui.SelectorSelectedItemProperty=function(){b.ui.SelectorSelectedItemProperty.base(this,"SelectedItem")},b.ui.SelectorProperty,{getDefaultBindingMode:function(){return b.binding.data.DataBindingMode.TwoWay},bindUpdateSourceTriggers:function(a){a.bindUpdateSourceEvent("change")}});
b.defineType(b.ui.SelectorDisplayProperty=function(){b.ui.SelectorDisplayProperty.base("DisplayEvaluator")},b.ui.SelectorProperty,{setValue:function(a){var c=a.getSourceValue(),c=b.binding.BindingContext.getInstance().parseBindingExpressions("data-bind","null:"+c)[0];this.getSelector(a).setDisplayEvaluator(c.getGetter())}});b.defineType(b.ui.SelectorValueProperty=function(){b.ui.SelectorValueProperty.base("ValueEvaluator")},b.ui.SelectorProperty,{setValue:function(a){var c=a.getSourceValue(),c=b.binding.BindingContext.getInstance().parseBindingExpressions("data-bind",
"null:"+c)[0];this.getSelector(a).setValueEvaluator(c.getGetter())}});b.binding.data.properties["select.selectedItem"]=new b.ui.SelectorSelectedItemProperty;b.binding.data.properties["select.items"]=new b.ui.SelectorItemsProperty;b.binding.data.properties["select.value"]=new b.ui.SelectorValueProperty;b.binding.data.properties["select.display"]=new b.ui.SelectorDisplayProperty})})(window);
